{% extends "site_base.html" %}

{% load i18n %}
{% load humanize i18n %}
{% load timezone_filters %}
{% load tagging_tags %}
{% load avatar_tags %}

{% block head_title %}{% trans "Tintz - A Rede Social de Quadrinhos" %}{% endblock %}

{% block main_content %}
<div class="span-7" id="left-panel">
    {% include "profiles/profile_left_panel.html" %}
</div>
<div class="span-8" id="center-panel">
    <div class="title-profile"><img src="{{MEDIA_URL}}/images/updates.png"><h2>Atualiza&ccedil;&otilde;es</h2></div>
    <div class="show_updates span-8">
        {% if updates %}
            <class id="list-updates">
                {% for update in updates %}
                    <div class="update-item span-8">
                        {% ifequal update.type "2" %}
                            <div class="update-avatar span-1"><a href="{% url profile_detail update.post.author %}" title="{{ update.post.author.get_profile.first_name }} {{ update.post.author.get_profile.last_name }}">{% avatar update.post.author 70 %}</a></div>
                            <div class="update-name span-3 last"><a href="{% url profile_detail update.post.author %}" title="{{ update.post.author.get_profile.first_name }} {{ update.post.author.get_profile.last_name }}">{{ update.post.author.get_profile.first_name }} {{ update.post.author.get_profile.last_name }}</a></div>

                            <a class="span-5 update-posts-title last" href="{{ update.post.get_absolute_url }}">{{ update.post.title }}</a>
                            <div class="span-5 update-posts-description last">
                                {{ update.post.get_small_text|force_escape|linebreaks|safe }}
                            </div>
                        {% else %}
                            <div class="update-avatar span-1"><a href="{% url profile_detail update.publication.author %}" title="{{ update.publication.author.get_profile.first_name }} {{ update.publication.author.get_profile.last_name }}">{% avatar update.publication.author 70 %}</a></div>
                            <div class="update-name span-3 last"><a href="{% url profile_detail update.publication.author %}" title="{{ update.publication.author.get_profile.first_name }} {{ update.publication.author.get_profile.last_name }}">{{ update.publication.author.get_profile.first_name }} {{ update.publication.author.get_profile.last_name }}</a></div>

                            <p class="update-pub-cover span-3 last">
                                <a href="{% url publication_details update.publication.author update.publication.id %}">
                                <img src="{{ MEDIA_URL }}{{ update.publication.get_thumbnail150_name|urlencode }}" href="{% url publication_details update.publication.author update.publication.id %}" alt="{{ update.publication.title }}"/></a>
                            </p>

                            <div class="update-pub-title span-5 last">
                                <a href="{% url publication_details update.publication.author update.publication.id %}">{{ update.publication.title }}</a>
                            </div>
                            <div class="update-pub-description span-5 last"><p>{{ update.publication.get_small_text }}</div>
                    {% endifequal %}
                </div>
            {% endfor %}
            </div>
            <div id="more_updates" class="more span-4 last">{% trans "Atualiza&ccedil;&otilde;es anteriores" %} >></div>
        {% else %}
            <class id="list-updates">
                <div class="update-item span-7">
                    <div class="span-7 update-pub-description">
                        <p>{% trans "Voc&ecirc; ainda n&atilde;o possui atualiza&ccedil;&otilde;es." %}
                        <p>{% trans "Comece agora mesmo a navegar e seguir novos usu&aacute;rios." %}
                        <p>{% trans "Veja nossas sugest&otilde;es de leitura e pessoas no canto direito da p&aacute;gina." %}
                    </div>
                </div>
            </div>
        {% endif %}
    </div>

<div class="span-8 last" id="right-panel">
    <div class="title-profile"><img src="{{MEDIA_URL}}/images/bt_publications.png"><h2>Sugest&otilde;es</h2></div>
    <div class="recommended-publications">
        <table>
            <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
            </tr>
            {% for related_publication in related_publications %}
                {% if forloop.counter0|divisibleby:"5" %}<tr>{% endif %}
                <td class="recomend-publication span-2 last">
                    <a href="{% url publication_details related_publication.author related_publication.id %}">
                    <img src="{{ MEDIA_URL }}{{ related_publication.get_basename|urlencode }}_001_thumb064{{related_publication.images_ext}}" href="javascript:fullscreen('{% url publication_details related_publication.author related_publication.id %}')" title="{{ related_publication.title }}"/></a>
                </td>
            {% endfor %}
            {% if followings|length|divisibleby:"5" %}{% else %}</tr>{% endif %}
        </table>
    </div>

    <div class="title-profile"><img src="{{MEDIA_URL}}/images/bt_contacts.png"><h2>Quem seguir</h2></div>

    <div id="list-profiles" class="profiles">
    {% for profile in other_profiles %}
       <tr><td>
       <div class="profiles-item span-8">
       <div class="avatar span-2"><a href="{% url profile_detail profile.username %}" title="{{ profile.get_profile.first_name }} {{ profile.get_profile.last_name }}">{% avatar profile 70 %}</a></div>

       {% if profile.get_profile.last_name %}
          <div class="profiles-details span-4 last"><a href="{% url profile_detail profile.username %}" title="{{ profile.get_profile.first_name }} {{ profile.get_profile.last_name }}">{{ profile.get_profile.first_name }} {{ profile.get_profile.last_name }}</a></div>
       {% else %}
            <div class="profiles-details span-4 last"><a href="{% url profile_detail profile.username %}" title="{{ profile.username }}">{{ profile.username }}</a></div>
       {% endif %}


       <div class="profiles-about span-4 last">{{ profile.get_profile.get_small_about|linebreaks }}</div>
       </div>
       </td></tr>
    {% endfor %}

    </div>


</div>
{% endblock %}

{% block extra_body %}
<script type="text/javascript">
    $(document).ready(function(){
        $("#more_updates").click(function(){
            $.ajax({
                type: "GET",
                url: "/profiles/get_updates/",
                dataType: "json",
                success: function(update){
                    $.each(update, function(i, item){
                        $("#list-updates").append('<h1>Ola mundo</h1>')
                    });
                }
            });
        });
    });
</script>
{% endblock %}
